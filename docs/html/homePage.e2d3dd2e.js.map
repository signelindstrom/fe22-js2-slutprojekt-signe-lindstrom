{"mappings":"AAAA,MAAMA,EAAcC,aAAaC,QAAQ,QAG5BC,GAFSF,aAAaC,QAAQ,UAEZ,qEAiBxBE,eAAeC,EAAgBC,GAClC,MAAMC,EAAWJ,EAAUG,EAErBE,QAAiBC,MAAMF,GAG7B,aAFmBC,EAASE,MAGhC,CCzBA,MAAMC,EAAcV,aAAaC,QAAQ,QACnCU,EAAgBX,aAAaC,QAAQ,UAErCW,EAAWC,SAASC,cAAc,cAGrBD,SAASC,cAAc,gBAC/BC,iBAAiB,SAAS,KACjCC,SAASC,OAAO,2BAGpB,MAAMC,EAAgBL,SAASC,cAAc,gBACvCK,EAAcN,SAASC,cAAc,cDgBpC,IAAuBM,EAAMC,EAAyCC,EAA/CF,ECdhBV,EDcsBW,ECdTV,EDckDW,ECdpBH,EAAfD,EDgBxBK,IAAMF,EACpBC,EAAgBE,UAAYJ,ECbhCjB,iBACI,MAAMsB,QAAarB,EAAgB,eAevC,SAAsBsB,GAElB,MAAMC,EAA4B,GAElCD,EAAUE,SAASC,IACf,MAAMC,SAAEA,EAAQT,OAAEA,EAAMU,MAAEA,GAAUF,EAEpC,GAAaG,MAATD,EAAoB,CAIpB,SAASE,EAAYC,GACjBA,EAAMN,SAASO,IACXvB,EAASwB,UAAY,GACrB,MAAMC,QAAEA,EAAOC,KAAEA,GAASH,EAEpBI,EAAwB,CAC1BC,KAAMH,EACNI,UAAWH,EACXlB,KAAMU,EACNY,IAAKrB,GAETM,EAAWgB,KAAKJ,GAGhBZ,EAAWiB,MAAK,SAAUC,EAAGC,GACzB,OAAOA,EAAEL,UAAYI,EAAEJ,SAC3B,IAGAd,EAAWC,SAASH,IAChB,MAAMsB,EAAelC,SAASmC,cAAc,OAC5CpC,EAASqC,OAAOF,GAChBA,EAAaG,UAAUC,IAAI,gBAC3B,MAAMC,EAAWvC,SAASmC,cAAc,KAClCK,EAAgBxC,SAASmC,cAAc,MACvCM,EAAsBzC,SAASmC,cAAc,OACnDD,EAAaE,OAAOK,EAAqBD,EAAeD,GAExDC,EAAc7B,UAAYC,EAAKL,KAC/BkC,EAAoB/B,IAAME,EAAKiB,IAC/BU,EAAS5B,UAAYC,EAAKe,IAAI,GAClC,GAGR,CAnCAP,EAFqBsB,OAAOC,OAAOzB,GAsCvC,IAGR,CA7DI0B,CAFkBF,OAAOC,OAAO/B,GAGpC,CANAiC,IDmBOvD,eAA2BwD,GAE9B,MAAMlC,QAAarB,EAAgB,cACjBmD,OAAOC,OAAO/B,GAItBG,SAASgC,IACX,MAAM9B,SAAEA,EAAQT,OAAEA,GAAWuC,EAC7B,GAAgB5B,MAAZF,GAAmCE,MAAVX,GAAuBS,GAAY/B,EAAa,CACzE,MAAM8D,EAAWhD,SAASmC,cAAc,OACxCW,EAAYV,OAAOY,GAEnB,MAAMC,EAAWjD,SAASmC,cAAc,OAClCe,EAAUlD,SAASmC,cAAc,OACvCc,EAAStC,UAAYM,EACrBiC,EAAQxC,IAAMF,EACdwC,EAASZ,OAAOa,EAAUC,GAE1BF,EAAS9C,iBAAiB,SAAS,KAC/Bf,aAAagE,QAAQ,WAAYlC,GACjC9B,aAAagE,QAAQ,iBAAkB3C,GACvC4C,YAAW,KACPjD,SAASC,OAAO,gCACjB,OAEX,IAGZ,CCuBA,CADoBJ,SAASC,cAAc,eAK3C,MAAMoD,EAAYrD,SAASC,cAAc,gBAClCoD,EDxBCnD,iBAAiB,SAAS,KAC1BC,SAASC,OAAO","sources":["src/modules/multiUseFunctions.ts","src/modules/homePage.ts"],"sourcesContent":["const currentUser = localStorage.getItem('user');\r\nconst currentAvatar = localStorage.getItem('avatar');\r\n\r\nexport const baseUrl: string = 'https://js2-7158b-default-rtdb.europe-west1.firebasedatabase.app/'\r\n\r\n// structure of database user-object\r\nexport type firebaseUser = {\r\n    username: string,\r\n    avatar: string,\r\n    password: string,\r\n    posts: postObject\r\n}\r\n\r\n// structure of database user posts-object\r\nexport type postObject = {\r\n    message: string,\r\n    time: number\r\n}\r\n\r\n// get firebase data\r\nexport async function getFirebaseData(url: string) {\r\n    const fetchUrl = baseUrl + url;\r\n\r\n    const response = await fetch(fetchUrl);\r\n    const data = await response.json();\r\n\r\n    return data\r\n}\r\n\r\n// create user profile\r\nexport function createProfile(user, avatar, avatarElement: HTMLImageElement, usernameElement: HTMLElement) {\r\n\r\n    avatarElement.src = avatar;\r\n    usernameElement.innerText = user;\r\n}\r\n\r\n\r\n// shows list of users + lets user view their profile\r\nexport async function getUserList(userListDiv: HTMLDivElement) {\r\n\r\n    const data = await getFirebaseData('users.json');\r\n    const userArray = Object.values(data);\r\n\r\n    listOfUsers(userArray)\r\n    function listOfUsers(array) {\r\n        array.forEach((list: firebaseUser) => {\r\n            const { username, avatar } = list;\r\n            if (username != undefined && avatar != undefined && username != currentUser) {\r\n                const userInfo = document.createElement('div');\r\n                userListDiv.append(userInfo);\r\n\r\n                const userName = document.createElement('div');\r\n                const userImg = document.createElement('img');\r\n                userName.innerText = username;\r\n                userImg.src = avatar;\r\n                userInfo.append(userName, userImg);\r\n\r\n                userInfo.addEventListener('click', () => {\r\n                    localStorage.setItem('viewUser', username);\r\n                    localStorage.setItem('viewUserAvatar', avatar);\r\n                    setTimeout(() => {\r\n                        location.assign('../html/profileViewer.html');\r\n                    }, 100);\r\n                })\r\n            }\r\n        })\r\n    }\r\n}\r\n\r\n// lets user log out, redirects user to login-page\r\nexport function logOut(btn: HTMLButtonElement) {\r\n    btn.addEventListener('click', () => {\r\n        location.assign('../index.html')\r\n    })\r\n}","import { getUserList, firebaseUser, logOut, baseUrl, createProfile, getFirebaseData, postObject } from \"./multiUseFunctions\";\r\n\r\nconst currentUser = localStorage.getItem('user');\r\nconst currentAvatar = localStorage.getItem('avatar');\r\n\r\nconst postsDiv = document.querySelector('#all-posts') as HTMLDivElement;\r\n\r\n// redirects user to their profile\r\nconst goToMyPage = document.querySelector('#my-page-btn') as HTMLButtonElement;\r\ngoToMyPage.addEventListener('click', () => {\r\n    location.assign('../html/profile.html');\r\n})\r\n\r\nconst displayAvatar = document.querySelector('#user-avatar') as HTMLImageElement;\r\nconst displayName = document.querySelector('#user-name') as HTMLElement;\r\n\r\ncreateProfile(currentUser, currentAvatar, displayAvatar, displayName);\r\n\r\n// get and display all posts\r\ngetPosts();\r\nasync function getPosts() {\r\n    const data = await getFirebaseData(`users.json`);\r\n    const userArray = Object.values(data);\r\n\r\n    showAllPosts(userArray);\r\n}\r\n\r\n// object structure for postsArray\r\ntype postForFeed = {\r\n    post: string,\r\n    timestamp: number,\r\n    user: string,\r\n    avi: string\r\n}\r\n\r\n// gets all info about posts and shows posts in cronological order\r\nfunction showAllPosts(dataArray) {\r\n\r\n    const postsArray: postForFeed[] = [];\r\n\r\n    dataArray.forEach((element: firebaseUser) => {\r\n        const { username, avatar, posts } = element;\r\n\r\n        if (posts != undefined) {\r\n            const messageArray = Object.values(posts);\r\n\r\n            getAllPosts(messageArray);\r\n            function getAllPosts(array) {\r\n                array.forEach((postObj: postObject) => {\r\n                    postsDiv.innerHTML = '';\r\n                    const { message, time } = postObj;\r\n\r\n                    const feedPost: postForFeed = {\r\n                        post: message,\r\n                        timestamp: time,\r\n                        user: username,\r\n                        avi: avatar\r\n                    }\r\n                    postsArray.push(feedPost)\r\n\r\n                    // sorts posts in cronological order\r\n                    postsArray.sort(function (a, b) {\r\n                        return b.timestamp - a.timestamp\r\n                    })\r\n\r\n                    // displays posts\r\n                    postsArray.forEach((data) => {\r\n                        const homepagePost = document.createElement('div');\r\n                        postsDiv.append(homepagePost);\r\n                        homepagePost.classList.add('homepagePost')\r\n                        const userPost = document.createElement('p');\r\n                        const userWhoPosted = document.createElement('h3');\r\n                        const userWhoPostedAvatar = document.createElement('img');\r\n                        homepagePost.append(userWhoPostedAvatar, userWhoPosted, userPost);\r\n\r\n                        userWhoPosted.innerText = data.user;\r\n                        userWhoPostedAvatar.src = data.avi;\r\n                        userPost.innerText = data.post;\r\n                    })\r\n\r\n                })\r\n            }\r\n        }\r\n\r\n    });\r\n}\r\n\r\n\r\n// gets list of users from database and displays them in div\r\nconst userListDiv = document.querySelector('#user-list') as HTMLDivElement;\r\ngetUserList(userListDiv);\r\n\r\n\r\n// log out redirects to login-page\r\nconst logOutBtn = document.querySelector('#log-out-btn') as HTMLButtonElement;\r\nlogOut(logOutBtn);"],"names":["$690f99fc8af240e0$var$currentUser","localStorage","getItem","$690f99fc8af240e0$export$a135e81e9a047f61","async","$690f99fc8af240e0$export$35d7b35fee7b6919","url","fetchUrl","response","fetch","json","$99631b5f5dacb4bd$var$currentUser","$99631b5f5dacb4bd$var$currentAvatar","$99631b5f5dacb4bd$var$postsDiv","document","querySelector","addEventListener","location","assign","$99631b5f5dacb4bd$var$displayAvatar","$99631b5f5dacb4bd$var$displayName","user","avatar","usernameElement","src","innerText","data","dataArray","postsArray","forEach","element","username","posts","undefined","getAllPosts","array","postObj","innerHTML","message","time","feedPost","post","timestamp","avi","push","sort","a","b","homepagePost","createElement","append","classList","add","userPost","userWhoPosted","userWhoPostedAvatar","Object","values","$99631b5f5dacb4bd$var$showAllPosts","$99631b5f5dacb4bd$var$getPosts","userListDiv","list","userInfo","userName","userImg","setItem","setTimeout","$99631b5f5dacb4bd$var$logOutBtn"],"version":3,"file":"homePage.e2d3dd2e.js.map"}